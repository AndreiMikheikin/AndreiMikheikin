function handleDragStart(e){e.currentTarget.classList.add("dragging"),e.dataTransfer.setData("text/plain",e.currentTarget.id)}function handleDragEnd(e){e.currentTarget.classList.remove("dragging")}function handleDragOver(e){e.preventDefault()}function handleDrop(e){e.preventDefault();const t=e.dataTransfer.getData("text/plain"),n=document.getElementById(t),o=document.getElementById("admin-dashboard-container"),d=e.clientX-o.getBoundingClientRect().left,a=e.clientY-o.getBoundingClientRect().top,i=Math.max(0,Math.min(d-n.offsetWidth/2,o.offsetWidth-n.offsetWidth)),r=Math.max(0,Math.min(a-n.offsetHeight/2,o.offsetHeight-n.offsetHeight));n.style.left=`${i}px`,n.style.top=`${r}px`,saveIconPositions()}function handleTouchEnd(e){const t=e.currentTarget.id;setTimeout(()=>{switch(t){case ICON1_ID:showDishForm();break;case ICON2_ID:showMenu();break;case ICON3_ID:showPurchaseCalculationForm();break;case ICON4_ID:showOrderForm();break;case ICON5_ID:showCollectionButtons()}},200)}function hideWelcomeModal(){const e=document.getElementById("welcome-modal");if(e){e.classList.add("hidden"),e.removeEventListener("touchstart",handleTouchStart),e.removeEventListener("touchend",handleTouchEndGesture);document.getElementById("close-button").removeEventListener("click",hideWelcomeModal),showAdminDashboard()}else console.error("Modal element not found in the DOM.")}function showAdminDashboard(){document.getElementById("admin-dashboard-container").classList.remove("hidden"),loadAdminDashboard()}function handleTouchStart(e){const t=e.touches[0];startX=t.clientX,startY=t.clientY}function handleTouchEndGesture(e){const t=e.changedTouches[0].clientY-startY;Math.abs(t)>50&&t<0&&handleSwipeUp(e)}function handleSwipeUp(e){e.stopPropagation(),console.log("Swipe up detected - closing modal"),hideWelcomeModal()}import{firebaseConfig}from"../../firebase-config.js";import{getApp,getApps,initializeApp}from"firebase/app";import{getAuth}from"firebase/auth";import{getFirestore}from"firebase/firestore";import{loadAdminDashboard,showCollectionButtons}from"./admin.js";export const app=getApps().length?getApp():initializeApp(firebaseConfig);export const auth=getAuth(app);export const db=getFirestore(app);const ICON1_ID="icon1",ICON2_ID="icon2",ICON3_ID="icon3",ICON4_ID="icon4",ICON5_ID="icon5";export function saveIconPositions(){const e=document.querySelectorAll(".icon-container"),t=Array.from(e).map(e=>({id:e.id,left:e.style.left,top:e.style.top}));localStorage.setItem("iconPositions",JSON.stringify(t))};export function initializeDragAndDrop(){document.querySelectorAll(".icon-container").forEach(e=>{e.addEventListener("dragstart",handleDragStart),e.addEventListener("dragend",handleDragEnd)});const e=document.getElementById("admin-dashboard-container");e.addEventListener("dragover",handleDragOver),e.addEventListener("drop",handleDrop)};export function addIconEventListeners(){document.getElementById(ICON1_ID).addEventListener("dblclick",showDishForm),document.getElementById(ICON2_ID).addEventListener("dblclick",showMenu),document.getElementById(ICON3_ID).addEventListener("dblclick",showPurchaseCalculationForm),document.getElementById(ICON4_ID).addEventListener("dblclick",showOrderForm),document.getElementById(ICON5_ID).addEventListener("dblclick",showCollectionButtons),document.getElementById(ICON1_ID).addEventListener("touchend",handleTouchEnd),document.getElementById(ICON2_ID).addEventListener("touchend",handleTouchEnd),document.getElementById(ICON3_ID).addEventListener("touchend",handleTouchEnd),document.getElementById(ICON4_ID).addEventListener("touchend",handleTouchEnd),document.getElementById(ICON5_ID).addEventListener("touchend",handleTouchEnd)};let startY=0,startX=0;export function showWelcomeModal(e){const t=document.getElementById("welcome-modal"),n=document.getElementById("welcome-message"),o=document.getElementById("close-button");if(t&&n&&o){const d=e?e.split("@")[0]:"Гость";n.textContent=`Добро пожаловать, ${d}!`,t.classList.remove("hidden"),t.addEventListener("touchstart",handleTouchStart),t.addEventListener("touchend",handleTouchEndGesture),o.addEventListener("click",hideWelcomeModal)}else console.error("One or more elements not found in the DOM.")};